{"version":3,"sources":["js003.js"],"names":["Calculate","wrap_selector","el_btnWrap","calculate_objects","current_Numbers_array","answer","is_done_calculating","vm","document","querySelector","addEventListener","count","bind","length","map","item","number","join","format_marks","act","update_formula_element","update_answer_element","el_formula","getElementById","textContent","formula","el_answer","current_nums","get_answer","key","mark","division","times","plus","minus","equal","num","result","original","point","find","undefined","new_numbers","delete_last_in_ary","detect_equal_and_delete","get_new_calculate_objects","ary","pop","target","string","Number","reduce","accum","currentValue","currentIndex","array","e","dataset","action","before_adding_number_to_current_num","get_number","get_point","set_formula_and_clear_current_num","return_answer_string","update_elements","cal","init"],"mappings":"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","sourcesContent":["/**\n *  * 變數\n *      * 算式\n *          * 新數字 (進到算式之前先存為字串，判斷小數點)\n *          * 新動作 (加減乘除、=、AC)\n *  * 判斷點誰 => 做甚麼是\n *      * 數字            => 先存為字串\n *      * 'AC'           => 全部刪除\n *      * '加減乘除'      => (當前結果) 與 (新數字，此時存為number) 計算\n *      * '='            => (當前結果) 輸出\n *      * '.'            => 判斷小數點是否位置正確\n *          * 當前無值 => '0', '.'\n *          * 當前有值 =>\n *              * 舊字串無'.' => '舊字串', '.'\n *              * 舊字串有'.' => '舊字串'\n */\nclass Calculate {\n    constructor(wrap_selector) {\n        this.el_btnWrap = wrap_selector\n        // * eg: [{ act:'division', number: '10.2' }]\n        this.calculate_objects = []\n        // * eg: ['1','2','.','2']\n        this.current_Numbers_array = []\n        this.answer = null\n        this.is_done_calculating = false\n    }\n\n    init() {\n        const vm = this\n        if (document.querySelector(vm.el_btnWrap))\n            document\n                .querySelector(vm.el_btnWrap)\n                .addEventListener('click', vm.count.bind(vm))\n    }\n\n    // return Array\n    // 顯示在最上方的公式，不包含現在正在加值的數字\n    get formula() {\n        if (this.calculate_objects.length === 0) return ''\n        return this.calculate_objects\n            .map(\n                (item) =>\n                    `${item.number.join('')} ${this.format_marks(item.act)} `\n            )\n            .join('')\n    }\n\n    get current_nums() {\n        return this.current_Numbers_array.join('')\n    }\n\n    get get_answer() {\n        return this.answer\n    }\n\n    update_elements() {\n        this.update_formula_element()\n        this.update_answer_element()\n    }\n\n    update_formula_element() {\n        const el_formula = document.getElementById('current_formula')\n        el_formula.textContent = this.formula\n    }\n\n    update_answer_element() {\n        const el_answer = document.getElementById('current_answer')\n        if (this.current_nums === '' && this.get_answer === null)\n            el_answer.textContent = ''\n        else\n            el_answer.textContent =\n                this.current_nums === '' ? this.get_answer : this.current_nums\n    }\n\n    format_marks(key) {\n        const mark = {\n            division: '÷',\n            times: '×',\n            plus: '+',\n            minus: '-',\n            equal: '=',\n        }\n        return mark[key]\n    }\n\n    /**\n     *  * 若傳入 0 || d-0 則判斷是否直接在 current_Numbers_array push 0 || 00\n     *  * 若非，則取代 current_Numbers_array 第一個 0，或是 push 新數字\n     *  @param {String} num\n     *  @return {Array}\n     */\n    get_number(num = '') {\n        const result = [...this.current_Numbers_array]\n        switch (num) {\n            case '0':\n            case 'd-0':\n                if (result.length === 0) return ['0']\n                if (result[0] === '0') return ['0']\n                if (num === '0') return ['0']\n                return [...result, '0', '0']\n            default:\n                if (result.length === 1) if (result[0] === '0') return [num]\n                return [...result, num]\n        }\n    }\n\n    /**\n     *  * 判斷 original = [] 是否有小數點\n     *      * 1. 長度為 0               => return 0.\n     *      * 2. 長度不為0 && 沒有\".\"    => push \".\"\n     *      * 3. 都不是就直接回傳原值\n     *\n     *  @param  {array} original\n     *  @return {array}\n     */\n    get_point(original = []) {\n        const point = () => original.find((item) => item === '.')\n        if (original.length === 0) return ['0', '.']\n        if (point() === undefined) return [...original, '.']\n        return [...original]\n    }\n\n    get_new_calculate_objects(mark = '') {\n        const current_nums = this.current_Numbers_array\n        const new_numbers =\n            current_nums[current_nums.length - 1] === '.'\n                ? this.delete_last_in_ary(current_nums)\n                : current_nums\n        return {\n            act: mark,\n            number: new_numbers,\n        }\n    }\n\n    before_adding_number_to_current_num() {\n        const vm = this\n        vm.detect_equal_and_delete()\n        vm.is_done_calculating = false\n    }\n\n    // * 若回傳目前輸入值的物件裡的數字陣列長度不為 0，則加入儲存計算公式的物件\n    // * 並且清除目前輸入值的陣列 (this.current_Numbers_array)\n    set_formula_and_clear_current_num(mark = '') {\n        const vm = this\n        if (vm.get_new_calculate_objects(mark)['number'].length !== 0)\n            vm.calculate_objects = [\n                ...vm.calculate_objects,\n                vm.get_new_calculate_objects(mark),\n            ]\n        vm.current_Numbers_array = []\n    }\n\n    detect_equal_and_delete() {\n        if (this.is_done_calculating) {\n            this.current_Numbers_array = []\n            this.calculate_objects = []\n            this.answer = null\n        }\n    }\n\n    delete_last_in_ary(ary) {\n        const result = [...ary]\n        result.pop()\n        return result\n    }\n\n    return_answer_string() {\n        const target = [...this.calculate_objects]\n        const num = (string) => Number(string)\n        return target.reduce((accum, currentValue, currentIndex, array) => {\n            if (currentIndex > 0) {\n                switch (array[currentIndex - 1].act) {\n                    case 'division':\n                        return num(accum) / num(currentValue.number.join(''))\n                    case 'times':\n                        return num(accum) * num(currentValue.number.join(''))\n                    case 'plus':\n                        return num(accum) + num(currentValue.number.join(''))\n                    case 'minus':\n                        return num(accum) - num(currentValue.number.join(''))\n                    default:\n                        throw '抓不到正確的運算符號 (+, -, *, /,)'\n                }\n            } else return num(currentValue.number.join(''))\n        }, 0)\n    }\n\n    count(e) {\n        if (e.target.dataset.action === undefined) return\n        const vm = this\n        const action = e.target.dataset.action\n        switch (action) {\n            case '0':\n            case '1':\n            case '2':\n            case '3':\n            case '4':\n            case '5':\n            case '6':\n            case '7':\n            case '8':\n            case '9':\n            case 'd-0':\n                vm.before_adding_number_to_current_num()\n                vm.current_Numbers_array = vm.get_number(action)\n                break\n            case 'point':\n                vm.before_adding_number_to_current_num()\n                vm.current_Numbers_array = vm.get_point(\n                    vm.current_Numbers_array\n                )\n                break\n            case 'division':\n            case 'times':\n            case 'plus':\n            case 'minus':\n                vm.set_formula_and_clear_current_num(action)\n                break\n            case 'ac':\n                vm.calculate_objects = []\n                vm.current_Numbers_array = []\n                vm.answer = null\n                break\n            case 'delete':\n                vm.current_Numbers_array = vm.delete_last_in_ary(\n                    vm.current_Numbers_array\n                )\n                break\n            case 'equal':\n                vm.set_formula_and_clear_current_num(action)\n                vm.answer = vm.return_answer_string()\n                vm.is_done_calculating = true\n                break\n        }\n        this.update_elements()\n    }\n}\n\nconst cal = new Calculate('.btnsWrap').init()\n"],"file":"js003.js"}